#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative "../lib/source_monitor/release/runner"

version = ARGV.shift

if version.nil? || version.strip.empty?
  warn "Usage: bin/release VERSION"
  exit 1
end

begin
  SourceMonitor::Release::Runner.new(version:).call
rescue SourceMonitor::Release::Runner::CommandFailure => e
  warn e.message
  exit 1
rescue StandardError => e
  warn "Release failed: #{e.message}"
  exit 1
end
