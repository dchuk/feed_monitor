<div class="space-y-8">
  <div class="flex flex-col justify-between gap-4 sm:flex-row sm:items-start">
    <div>
      <h1 class="text-3xl font-semibold text-slate-900"><%= @item.title.presence || "(untitled)" %></h1>
      <p class="mt-1 text-sm text-slate-500">
        <% if @item.source %>
          From <%= link_to @item.source.name, feed_monitor.source_path(@item.source), class: "text-blue-600 hover:text-blue-500" %>
        <% else %>
          <span class="text-slate-400">No source</span>
        <% end %>
        &middot;
        <%= @item.published_at ? @item.published_at.strftime("%b %d, %Y %H:%M %Z") : "Unpublished" %>
      </p>
    </div>
    <div class="flex flex-wrap gap-3">
      <% if @item.url.present? %>
        <%= link_to "View Original", @item.url, target: "_blank", rel: "noopener", class: "inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white shadow hover:bg-blue-500" %>
      <% end %>
    </div>
  </div>

  <div class="grid gap-6 lg:grid-cols-2">
    <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
      <div class="border-b border-slate-200 px-5 py-4">
        <h2 class="text-lg font-medium">Item Details</h2>
      </div>
      <dl class="divide-y divide-slate-100">
        <% details = {
             "GUID" => @item.guid,
             "Content Fingerprint" => @item.content_fingerprint || "—",
             "URL" => @item.url,
             "Canonical URL" => @item.canonical_url || "—",
             "Author" => @item.author || "—",
             "Published At" => (@item.published_at&.strftime("%b %d, %Y %H:%M %Z") || "—"),
             "Updated At (Source)" => (@item.updated_at_source&.strftime("%b %d, %Y %H:%M %Z") || "—"),
             "Language" => @item.language || "—",
             "Scrape Status" => (@item.scrape_status || "Not Scraped").titleize,
             "Scraped At" => (@item.scraped_at&.strftime("%b %d, %Y %H:%M %Z") || "—")
           } %>
        <% details.each do |label, value| %>
          <div class="flex items-center justify-between px-5 py-3">
            <dt class="text-sm font-medium text-slate-600"><%= label %></dt>
            <dd class="max-w-[60%] text-sm text-slate-900 break-words"><%= value %></dd>
          </div>
        <% end %>
      </dl>
    </div>

    <div class="space-y-6">
      <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
        <div class="border-b border-slate-200 px-5 py-4">
          <h2 class="text-lg font-medium">Counts & Metrics</h2>
        </div>
        <div class="px-5 py-4 text-sm text-slate-700 space-y-2">
          <p><span class="font-medium text-slate-600">Comments:</span> <%= @item.comments_count || 0 %></p>
          <p><span class="font-medium text-slate-600">Feed Items in Source:</span> <%= @item.source&.items_count || "—" %></p>
          <p><span class="font-medium text-slate-600">Categories:</span> <%= Array(@item.categories).presence&.join(", ") || "—" %></p>
          <p><span class="font-medium text-slate-600">Tags:</span> <%= Array(@item.tags).presence&.join(", ") || "—" %></p>
        </div>
      </div>

      <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
        <div class="border-b border-slate-200 px-5 py-4">
          <h2 class="text-lg font-medium">Metadata</h2>
        </div>
        <div class="px-5 py-4 text-sm text-slate-700">
          <% if @item.metadata.present? %>
            <pre class="whitespace-pre-wrap break-words text-xs text-slate-600"><%= JSON.pretty_generate(@item.metadata) %></pre>
          <% else %>
            <p class="text-slate-500">No metadata recorded.</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="space-y-6">
    <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
      <div class="border-b border-slate-200 px-5 py-4">
        <h2 class="text-lg font-medium">Summary</h2>
      </div>
      <div class="px-5 py-4 text-sm text-slate-700">
        <% if @item.summary.present? %>
          <%= simple_format(@item.summary) %>
        <% else %>
          <p class="text-slate-500">No summary available.</p>
        <% end %>
      </div>
    </div>

    <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
      <div class="border-b border-slate-200 px-5 py-4">
        <h2 class="text-lg font-medium">Feed Content</h2>
      </div>
      <div class="px-5 py-4 text-sm text-slate-700">
        <% if @item.content.present? %>
          <%= simple_format(@item.content) %>
        <% else %>
          <p class="text-slate-500">No content captured from feed.</p>
        <% end %>
      </div>
    </div>

    <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
      <div class="border-b border-slate-200 px-5 py-4">
        <h2 class="text-lg font-medium">Scraped HTML</h2>
      </div>
      <div class="px-5 py-4 text-sm text-slate-700">
        <% if @item.scraped_html.present? %>
          <pre class="whitespace-pre-wrap break-words text-xs text-slate-600"><%= @item.scraped_html %></pre>
        <% else %>
          <p class="text-slate-500">No scraped HTML available.</p>
        <% end %>
      </div>
    </div>

    <div class="rounded-lg border border-slate-200 bg-white shadow-sm">
      <div class="border-b border-slate-200 px-5 py-4">
        <h2 class="text-lg font-medium">Scraped Content</h2>
      </div>
      <div class="px-5 py-4 text-sm text-slate-700">
        <% if @item.scraped_content.present? %>
          <%= simple_format(@item.scraped_content) %>
        <% else %>
          <p class="text-slate-500">No scraped content available.</p>
        <% end %>
      </div>
    </div>
  </div>
</div>
